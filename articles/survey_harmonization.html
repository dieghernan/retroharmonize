<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Survey Harmonization • retroharmonize</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Survey Harmonization">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=B612+Mono:ital,wght@0,400;0,700;1,400;1,700&amp;family=Roboto+Mono:ital,wght@0,100..700;1,100..700&amp;display=swap" rel="stylesheet">
<!-- rogtemplate style sheet --><link href="../BS5/rogtemplate.min.css" rel="stylesheet">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">retroharmonize</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5.003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/retroharmonize.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rOpenGov/retroharmonize/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Survey Harmonization</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rOpenGov/retroharmonize/blob/master/vignettes/survey_harmonization.Rmd" class="external-link"><code>vignettes/survey_harmonization.Rmd</code></a></small>
      <div class="d-none name"><code>survey_harmonization.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://retroharmonize.dataobservatory.eu/" class="external-link">retroharmonize</a></span><span class="op">)</span></span></code></pre></div>
<p>Survey data harmonization refers to procedures that improve the data
comparability or the inferential capacity of multiple surveys. <em>Ex
ante</em> survey harmonization refers to planning and design steps to
make sure that not yet answered questionnaires can be better compared,
or data derived from them joined, integrated. Such procedures include
the harmonization of the questionnaire, the harmonization of the sample
design, and other aspects of carrying out multiple surveys. <em>Ex
post</em> or <em>retrospective harmonization</em> refers to procedures
to data that has been derived from surveys—i.e., survey that have been
carried out.</p>
<p>Naturally, better <em>ex ante</em> harmonization makes eventual data
integration or data comparison easier; yet often we can still harmonize
retrospectively survey data that has not been carefully pre-harmonized
before respondents have answered the questionnaire items.</p>
<p>Our aim with the <code>retroharmonize</code> R package is to provide
assistance to a reproducible research workflow in carrying out important
computational aspects of retrospective survey harmonization.</p>
<p>Let’s start with a very simple example.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://larmarange.github.io/labelled/" class="external-link">labelled</a></span><span class="op">)</span></span>
<span><span class="va">survey_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>, <span class="cn">NA_real_</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Male <span class="op">=</span> <span class="fl">1</span>, Female <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">survey_1</span>, <span class="st">"id"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Survey 1"</span></span>
<span></span>
<span><span class="va">survey_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  gender <span class="op">=</span> <span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>male <span class="op">=</span> <span class="fl">1</span>, female <span class="op">=</span> <span class="fl">2</span>, other <span class="op">=</span> <span class="fl">3</span>, declined <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">survey_2</span>, <span class="st">"id"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Survey 2"</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">survey_1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> sex_numeric <span class="op">=</span> <span class="fu"><a href="../reference/labelled_spss_survey.html">as_numeric</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>, </span>
<span>           sex_factor <span class="op">=</span> <span class="fu"><a href="../reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sex sex_numeric sex_factor</span></span>
<span><span class="co">#&gt; 1   1           1       Male</span></span>
<span><span class="co">#&gt; 2   1           1       Male</span></span>
<span><span class="co">#&gt; 3   0           0     Female</span></span>
<span><span class="co">#&gt; 4  NA          NA       &lt;NA&gt;</span></span></code></pre></div>
<div class="section level2">
<h2 id="tasks-in-the-harmonization-workflow">Tasks in the harmonization workflow<a class="anchor" aria-label="anchor" href="#tasks-in-the-harmonization-workflow"></a>
</h2>
<p>The ordering of the survey harmonization workflow is flexible, and it
is likely that even the same researcher would choose a different
workflow in the case of smaller, simpler harmonization tasks and more
complex harmonization tasks.</p>
<p>The data science aspect of a successful survey harmonization task is
the creation of a consistent data frame that contains harmonized
information from multiple surveys. It practically means that
questionnaire items are mapped into variables with a consistent
numerical coding, descriptive metadata (variable and value labels) and a
consistent handling of missing and special values. This may be very
laborous task when surveys are conducted in different years, saved in
different file formats with a different metadata structure, missing and
special values are handled differently, and the metadata contains
potentially different natural language descriptions or spelling.</p>
<p><code>Survey 1</code> labels the sex of respondents as
<code>Male</code> and <code>Female</code>, and has cases that are
neither <code>Male</code> or <code>Female</code>, but we do not know
why.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> gender_numeric <span class="op">=</span> <span class="fu"><a href="../reference/labelled_spss_survey.html">as_numeric</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>, </span>
<span>           gender_factor  <span class="op">=</span> <span class="fu"><a href="../reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   gender gender_numeric gender_factor</span></span>
<span><span class="co">#&gt; 1      1              1          male</span></span>
<span><span class="co">#&gt; 2      3              3         other</span></span>
<span><span class="co">#&gt; 3      9              9      declined</span></span>
<span><span class="co">#&gt; 4      1              1          male</span></span>
<span><span class="co">#&gt; 5      2              2        female</span></span></code></pre></div>
<p><code>Survey 2</code> records gender, which contains the same
information as sex in <code>Survey 1</code> (<code>Male</code> and
<code>Female</code>), but allows people to identify as
<code>Other</code>, and labels cases when people decline to identify
with any of these three categories.</p>
<p>In practice, you want to end up with the following joined
representation of your survey:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_joined</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>  survey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  gender <span class="op">=</span> <span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">9</span>, <span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>male <span class="op">=</span> <span class="fl">1</span>, female <span class="op">=</span> <span class="fl">0</span>, other <span class="op">=</span> <span class="fl">3</span>, declined <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">survey_joined</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"survey_"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">survey</span>, <span class="st">"_"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>,</span>
<span>           gender_numeric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA_real_</span>, <span class="fl">1</span>,<span class="fl">3</span>,<span class="cn">NA_real_</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>           gender_factor  <span class="op">=</span> <span class="fu"><a href="../reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>, </span>
<span>           is_female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span> <span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender_numeric</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           id survey gender gender_numeric gender_factor is_female</span></span>
<span><span class="co">#&gt; 1 survey_1_1      1      1              1          male         0</span></span>
<span><span class="co">#&gt; 2 survey_1_2      1      1              1          male         0</span></span>
<span><span class="co">#&gt; 3 survey_1_3      1      0              0        female         1</span></span>
<span><span class="co">#&gt; 4 survey_1_4      1      9             NA      declined        NA</span></span>
<span><span class="co">#&gt; 5 survey_2_1      2      1              1          male         0</span></span>
<span><span class="co">#&gt; 6 survey_2_2      2      3              3         other         0</span></span>
<span><span class="co">#&gt; 7 survey_2_3      2      9             NA      declined        NA</span></span>
<span><span class="co">#&gt; 8 survey_2_4      2      1              1          male         0</span></span>
<span><span class="co">#&gt; 9 survey_2_5      2      0              0        female         1</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Harmonization of concepts
<ul>
<li>Create a mental map of the measured concepts that needs to be
harmonized. Which variables contain sufficiently similar information
that can be harmonized? In our simple example, we want to harmonize a
binary sex with missing cases and a four-level categorical variable on
gender identification, and concatenate the harmonized vectors by binding
or joining the Survey 1 and Survey 2 data frames.</li>
<li>Our metadata function help mapping the information stored in the
file representations of multiple surveys. We want to create a simple
inventory of numerical codes, value ranges, missing cases and variable
labels.</li>
</ul>
</li>
<li>Variable names
<ul>
<li>Data measuring sufficiently similar concepts, i.e. data that can be
harmonized, is stored in variables that have the same name in different
data frames representing the survey, therefore they can be bind or
joined together. We want to join or bind by rows <code>survey_1</code>
with <code>survey_2</code>, or, we want to concatenate
<code>survey_1$sex</code> with <code>survey_2$gender</code>.</li>
<li>Descriptive metadata about the variable, such as “variable labels”
in SPSS files, is recorded for documentation, and if needed, harmonized
across surveys. In SPSSS, <code>survey_1$sex</code> may come with a
variable label something like <em>SEX OF RESPONDENT</em>, and
<code>survey_2$gender</code> may be labelled as <em>GENDER
IDENTIFICATION</em>. This label should be harmonized to <em>Sex or
gender or the respondent</em>.</li>
</ul>
</li>
<li>Variable coding and labels
<ul>
<li>Variables recording or measuring the same concept, such as the
gender of the respondent, are coded exactly the same way, for example,
females with 0, males with 1, non-binary respondents with 3, and people
declining to reveal their gender with 9. This means that observations in
<code>survey_2$gender</code> coded with a numeric 2 must be changed to a
numeric 0.</li>
<li>Variable labels are used consistently and in exactly the same way,
i.e. <code>survey_1$sex</code> <em>Female</em> respondents and
<code>survey_2$gender</code> <em>female</em> respondents will be
consistently labelled as <em>female</em>.</li>
</ul>
</li>
<li>Variable types
<ul>
<li>Variables recording or measuring the same concept are stored in
exactly the same R type, and they can be consistently concatenated
across surveys, or they can be subsetted, cross-cutting surveys, for
example, all female respondents from Survey 1 and Survey 2 can be
subsetted into a female vector.</li>
<li>The labelled class of <a href="https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html" class="external-link">labelled</a>
is not sufficiently strict, because it allows inconsistent special
(missing) values. Our inherited <a href="https://retroharmonize.dataobservatory.eu/reference/labelled_spss_survey.html" class="external-link">labelled_spss_survey</a>
consistently contains codes, labels, missing ranges and missing values,
and therefore it can be concatenated.</li>
<li>The numeric or factor representation of <code>survey_1$sex</code>
and <code>survey_2$gender</code> can be technically concatenated, but
before harmonization this will create logical errors, because females
will be either coded with 0 or with 2. The <code><a href="../reference/labelled_spss_survey.html">as_numeric()</a></code> and
<code><a href="../reference/as_factor.html">as_factor()</a></code> methods of our <a href="https://retroharmonize.dataobservatory.eu/reference/labelled_spss_survey.html" class="external-link">labelled_spss_survey</a>
class handle consistency issues.</li>
</ul>
</li>
<li>Reproducibility
<ul>
<li>The revision, checking, external review and audit of the data
requires that the steps can be replicated by a third party. This
requires a documentation of the harmonization steps, i.e., 1=Women in
Survey 1, and 0=female in Survey 2 became 0=females in the harmonized
dataset.</li>
<li>Our <a href="https://retroharmonize.dataobservatory.eu/reference/survey.html" class="external-link">survey</a>
class is derived from <a href="https://tibble.tidyverse.org/" class="external-link">tibble</a>, the modernized version
of the base <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code>. It contains various descriptive
metadata about the survey among attributes.</li>
</ul>
</li>
</ol>
<p>The joining of the not harmonized datasets results in the following
data frame.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">survey_1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> survey <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           sex_numeric <span class="op">=</span> <span class="fu"><a href="../reference/labelled_spss_survey.html">as_numeric</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>, </span>
<span>           sex_factor <span class="op">=</span> <span class="fu"><a href="../reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span> </span>
<span>    <span class="va">survey_2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> survey <span class="op">=</span> <span class="fl">2</span>, </span>
<span>               gender_numeric <span class="op">=</span> <span class="fu"><a href="../reference/labelled_spss_survey.html">as_numeric</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>, </span>
<span>               gender_factor  <span class="op">=</span> <span class="fu"><a href="../reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(survey)`</span></span>
<span><span class="co">#&gt;   sex survey sex_numeric sex_factor gender gender_numeric gender_factor</span></span>
<span><span class="co">#&gt; 1   1      1           1       Male     NA             NA          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2   1      1           1       Male     NA             NA          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3   0      1           0     Female     NA             NA          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4  NA      1          NA       &lt;NA&gt;     NA             NA          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5  NA      2          NA       &lt;NA&gt;      1              1          male</span></span>
<span><span class="co">#&gt; 6  NA      2          NA       &lt;NA&gt;      3              3         other</span></span>
<span><span class="co">#&gt; 7  NA      2          NA       &lt;NA&gt;      9              9      declined</span></span>
<span><span class="co">#&gt; 8  NA      2          NA       &lt;NA&gt;      1              1          male</span></span>
<span><span class="co">#&gt; 9  NA      2          NA       &lt;NA&gt;      2              2        female</span></span></code></pre></div>
<p>Performing only variable harmonization yields to a data frame that
has the correct dimensions, but it is not usable for statistical
analysis.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">survey_var_harmonized</span> <span class="op">&lt;-</span> <span class="va">survey_1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span> <span class="op">(</span> gender <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">sex</span> <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> survey <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           gender_numeric <span class="op">=</span> <span class="fu"><a href="../reference/labelled_spss_survey.html">as_numeric</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>, </span>
<span>           gender_factor  <span class="op">=</span> <span class="fu"><a href="../reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span> </span>
<span>    <span class="va">survey_2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> survey <span class="op">=</span> <span class="fl">2</span>, </span>
<span>               gender_numeric <span class="op">=</span> <span class="fu"><a href="../reference/labelled_spss_survey.html">as_numeric</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>, </span>
<span>               gender_factor  <span class="op">=</span> <span class="fu"><a href="../reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"survey"</span>, <span class="st">"gender_numeric"</span>, <span class="st">"gender_factor"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `"sex"` instead of `.data$sex`</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: `gender` and `gender` have conflicting value labels.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Labels for these values will be taken from `gender`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Values: <span style="color: #0000BB;">1</span></span></span></code></pre></div>
<p>Apart from the simple, descriptive variable of the survey
identification, non of the descriptive statistics are meaningful.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">survey_var_harmonized</span><span class="op">)</span></span>
<span><span class="co">#&gt;      gender         survey      gender_numeric  gender_factor</span></span>
<span><span class="co">#&gt;  Min.   :0.00   Min.   :1.000   Min.   :0.00   Female  :1    </span></span>
<span><span class="co">#&gt;  1st Qu.:1.00   1st Qu.:1.000   1st Qu.:1.00   Male    :2    </span></span>
<span><span class="co">#&gt;  Median :1.00   Median :2.000   Median :1.00   male    :2    </span></span>
<span><span class="co">#&gt;  Mean   :2.25   Mean   :1.556   Mean   :2.25   female  :1    </span></span>
<span><span class="co">#&gt;  3rd Qu.:2.25   3rd Qu.:2.000   3rd Qu.:2.25   other   :1    </span></span>
<span><span class="co">#&gt;  Max.   :9.00   Max.   :2.000   Max.   :9.00   declined:1    </span></span>
<span><span class="co">#&gt;  NA's   :1                      NA's   :1      NA's    :1</span></span></code></pre></div>
<p>The variable labels must be harmonized for a successful factor
representation. The numerical coding must be harmonized, and the missing
cases must be consistently handled to achieve any useful numerical
representation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_joined</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span> <span class="op">(</span> id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"survey_"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">survey</span>, <span class="st">"_"</span>, <span class="va">.data</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>,</span>
<span>           gender_numeric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA_real_</span>, <span class="fl">1</span>,<span class="fl">3</span>,<span class="cn">NA_real_</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>           gender_factor  <span class="op">=</span> <span class="fu"><a href="../reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>, </span>
<span>           female_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span> <span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">gender_numeric</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;       id                survey          gender      gender_numeric</span></span>
<span><span class="co">#&gt;  Length:9           Min.   :1.000   Min.   :0.000   Min.   :0.0   </span></span>
<span><span class="co">#&gt;  Class :character   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:0.5   </span></span>
<span><span class="co">#&gt;  Mode  :character   Median :2.000   Median :1.000   Median :1.0   </span></span>
<span><span class="co">#&gt;                     Mean   :1.556   Mean   :2.778   Mean   :1.0   </span></span>
<span><span class="co">#&gt;                     3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:1.0   </span></span>
<span><span class="co">#&gt;                     Max.   :2.000   Max.   :9.000   Max.   :3.0   </span></span>
<span><span class="co">#&gt;                                                     NA's   :2     </span></span>
<span><span class="co">#&gt;   gender_factor  female_ratio   </span></span>
<span><span class="co">#&gt;  female  :2     Min.   :0.0000  </span></span>
<span><span class="co">#&gt;  male    :4     1st Qu.:0.0000  </span></span>
<span><span class="co">#&gt;  other   :1     Median :0.0000  </span></span>
<span><span class="co">#&gt;  declined:2     Mean   :0.2857  </span></span>
<span><span class="co">#&gt;                 3rd Qu.:0.5000  </span></span>
<span><span class="co">#&gt;                 Max.   :1.0000  </span></span>
<span><span class="co">#&gt;                 NA's   :2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-we-help-harmonization">How we help harmonization<a class="anchor" aria-label="anchor" href="#how-we-help-harmonization"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>The <em>data importing</em> functions make sure that survey data
and metadata are carefully translated to R data classes and variable
types.</p></li>
<li><p>The <em>metadata functions</em> help the analysis, normalization
and joining of the metadata aspects (variable and value labels, original
variable names, unique identifiers) across surveys.</p></li>
<li><p><em>Harmonization functions</em> help the harmonization of
responses to questionnaire items, i.e. making sure that coded values,
the labelling of values, and missing data are handled consistently
across multiple surveys.</p></li>
</ol>
<p>Our package was tested on multiple, international, harmonized
surveys, particularly the Eurobarometer, the Afrobarometer and the Arab
Barometer survey programs. Different users, and different task call for
different workflows. We created a number of helper functions to assist
various workflows.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://reprex.nl/authors/daniel_antal/" class="external-link">Daniel Antal</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>



    <!-- Add ropengov logo -->
  <script src="../BS5/logo.js"></script>
</body>
</html>
